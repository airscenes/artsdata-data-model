@prefix dash: <http://datashapes.org/dash#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix schema: <http://schema.org/> .
@prefix sh: <http://www.w3.org/ns/shacl#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix ads: <http://kg.artsdata.ca/shacl/> .
ads:EventSeriesShape
    a sh:NodeShape ;
    sh:targetClass schema:EventSeries ;
    sh:property ads:subEventPropertySh .
ads:subEventPropertySh
    a sh:PropertyShape ;
    sh:path schema:subEvent ;
    sh:minCount 1 .
    
ads:EventShape
    a sh:NodeShape ;
    sh:closed true ;
    # Sub-types of Event
    sh:targetClass schema:Event, schema:EventSeries, schema:MusicEvent, schema:TheaterEvent, schema:ComedyEvent ;
    sh:targetClass schema:DanceEvent, schema:ExhibitionEvent, schema:Festival, schema:ChildrensEvent, schema:ScreeningEvent;
    sh:targetClass schema:EducationEvent, schema:FoodEvent, schema:Hackathon, schema:LiteraryEvent, schema:PublicationEvent ;
    sh:targetClass schema:SaleEvent, schema:SocialEvent, schema:SportsEvent, schema:VisualArtsEvent ;
    sh:ignoredProperties ( rdf:type ) ;
    # TODO: Check that Event ID ends with #Event
    # Required Properties
    sh:property ads:NameSh, ads:LocationSh, ads:StartDateSh, ads:MainEntityOfPageSh ; 
    # Check optional properties
    sh:property ads:OrganizerSh, ads:PerformerSh, ads:EventAttendanceModeSh ;
    sh:property ads:EventStatusSh, ads:SubEventSh, ads:EndDateSh ;
    # Warnings for recommended properties
    sh:property ads:DescriptionWarningSh, ads:OrganizerWarningSh, ads:PerformerWarningSh, ads:ImageWarningSh, ads:NameWarningSh ;
    sh:property ads:MainEntityOfPageWarningSh, ads:UrlWarningSh, ads:EventAttendanceModeWarningSh, ads:EventStatusWarningSh, ads:SDDatePublishedSh ;
   .
# Event's Property Shapes
ads:NameSh
    sh:path schema:name ;
    sh:name "Name of event" ;
    sh:minCount 1 .
ads:NameWarningSh
    sh:path schema:name ;
    sh:severity sh:Warning ;
    sh:languageIn ( "en" "fr" ) ;
    sh:uniqueLang true .
ads:StartDateSh
    sh:path schema:startDate ;
    sh:datatype xsd:dateTime ;
    sh:maxCount 1 ;
    sh:minCount 1 ;
    sh:name "Start date and time of Event" .
ads:EndDateSh
    sh:path schema:endDate ;
    sh:datatype xsd:dateTime ;
    sh:maxCount 1 ;
    sh:minCount 0 .
ads:SDDatePublishedSh
    sh:path schema:sdDatePublished ;
    sh:datatype xsd:dateTime ;
    sh:maxCount 1 ;
    sh:minCount 0 .
ads:LocationSh
    sh:path schema:location ;
    sh:maxCount 1 ;
    sh:node ads:PlaceShape .
ads:SubEventSh
    sh:path schema:subEvent ;
    sh:minCount 0 ;
    sh:node ads:EventShape .
ads:EventStatusSh
    sh:path schema:eventStatus ;
    sh:maxCount  1 ;
    sh:order 19 ;
    sh:class schema:EventStatusType ;
    sh:in  ( schema:EventPostponed  schema:EventScheduled  schema:EventCancelled  schema:EventRescheduled  schema:EventMovedOnline )  .
ads:EventStatusWarningSh
    sh:path schema:eventStatus ;
    sh:severity sh:Warning ;
    sh:minCount  1 .
ads:EventAttendanceModeSh
    sh:path schema:eventAttendanceMode ;
    sh:maxCount  1 ;
    sh:class schema:EventAttendanceModeEnumeration ;
    sh:in  ( schema:OfflineEventAttendanceMode  schema:OnlineEventAttendanceMode schema:MixedEventAttendanceMode)  .
ads:EventAttendanceModeWarningSh
    sh:path schema:eventAttendanceMode ;
    sh:severity sh:Warning ;
    sh:minCount  1 .
ads:UrlWarningSh
    sh:path schema:url ;
    sh:severity sh:Warning ;
    sh:minCount  1 .
ads:MainEntityOfPageSh
    sh:path schema:mainEntityOfPage ;
    sh:pattern "#WebPage$" ;
    sh:node ads:WebPageShape .
ads:MainEntityOfPageWarningSh
    sh:path schema:mainEntityOfPage ;
    sh:severity sh:Warning ;
    sh:minCount  1 .
ads:DescriptionWarningSh
    sh:path schema:description ;
    sh:severity sh:Warning ;
    sh:languageIn ( "en" "fr" ) ;
    sh:uniqueLang true ;
    sh:minCount  1 .
ads:OrganizerSh
    sh:path schema:organizer ;
    sh:or (
        [ sh:node ads:PersonShape ; ]
        [ sh:node ads:OrganizationShape ; ]
    ) ;
    sh:message "organizer is not a valid Person or Organizatinon." .
ads:OrganizerWarningSh
    sh:path schema:performer ;
    sh:severity sh:Warning ;
    sh:minCount  1 .
ads:PerformerSh
    sh:path schema:performer ;
    sh:or (
        [ sh:node ads:PersonShape ; ]
        [ sh:node ads:OrganizationShape ; ]
    ) ;
    sh:message "performer is not a valid Person or Organizatinon." .
ads:PerformerWarningSh
    sh:path schema:organizer ;
    sh:severity sh:Warning ;
    sh:minCount  1 .
ads:ImageWarningSh
   sh:path schema:image ;
        sh:severity sh:Warning ;
        sh:minCount  1 .
# Node Shapes
ads:WebPageShape
    a sh:NodeShape ;
    sh:targetClass schema:WebPage ;
    sh:property [
        sh:path schema:inLanguage ;
        sh:minCount 1 ;
    ] .
ads:PersonShape
    a sh:NodeShape ;
    sh:targetClass schema:Person ;
    sh:property [
        sh:path schema:name ;
        sh:minCount 1 ;
    ] ;
    sh:property [
        sh:path schema:sameAs ;
        sh:pattern "^http" ;
        sh:description "sameAs properties must have URIs" ;
    ] .
ads:OrganizationShape
    a sh:NodeShape ;
    sh:targetClass schema:Orgnanization ;
    sh:property [
        sh:path schema:name ;
        sh:minCount 1 ;
    ] ;
        sh:property [
        sh:path schema:sameAs ;
        sh:pattern "^http" ;
        sh:description "sameAs properties must have URIs" ;
    ] .
   
ads:PlaceShape
    # TODO: Allow Postal Address OR Virtual Location
    a sh:NodeShape ;
    sh:targetClass schema:Place ;
    sh:closed true ;
    sh:ignoredProperties ( rdf:type ) ;
    sh:property [
        sh:path schema:name ;
        sh:languageIn ( "en" "fr" ) ;
        sh:uniqueLang true ;
        sh:minCount 1 ;
    ] ;
   sh:property [
      sh:path schema:address ;
     sh:node schema:PostalAddressShape ;
   ] .
ads:PostalAddressShape
    a sh:NodeShape ;
    sh:targetClass schema:PostalAddress ;
    sh:closed true ;
    sh:ignoredProperties ( rdf:type ) ;
   sh:property [
        sh:path schema:streetAddress ;
        sh:maxCount 1 ;
       sh:minCount 1 ;
       sh:datatype xsd:string ;
  ] ;
   sh:property [
        sh:path schema:streetAddress ;
        sh:maxCount 1 ;
       sh:minCount 1 ;
       sh:datatype xsd:string ;
  ] ;
   sh:property [    
        sh:path schema:addressCountry ;
        sh:maxCount 1 ;
       sh:minCount 1 ;
       sh:datatype xsd:string ;
  ] ;
   sh:property [
        sh:path schema:addressRegion ;
        sh:maxCount 1 ;
       sh:minCount 1 ;
       sh:datatype xsd:string ;
  ] ;
   sh:property [
        sh:path schema:postalCode ;
        sh:maxCount 1 ;
       sh:minCount 1 ;
       sh:datatype xsd:string ;
  ] ;
   sh:property [
        sh:path schema:addressLocality ;
        sh:maxCount 1 ;
       sh:minCount 1 ;
       sh:datatype xsd:string ;
  ] .
